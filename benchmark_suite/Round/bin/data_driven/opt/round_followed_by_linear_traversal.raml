
let incur_cost (hd : int) =
  if (hd mod 10) = 0 then Raml.tick 1.0 else Raml.tick 0.5

let rec double (xs : int list) =
  match xs with [] -> [] | hd :: tl -> hd :: hd :: double tl

let rec half (xs : int list) =
  match xs with [] -> [] | [ x ] -> [] | x1 :: x2 :: tl -> x1 :: half tl

let rec round (xs : int list) =
  match xs with
  | [] -> []
  | hd :: tl ->
      let half_result = half tl in
      let recursive_result = round half_result in
      hd :: double recursive_result

let rec linear_traversal (xs : int list) =
  match xs with
  | [] -> []
  | hd :: tl ->
      let _ = incur_cost hd in
      hd :: linear_traversal tl

let round_followed_by_linear_traversal2 (xs : int list) =
  let round_result = round xs in
  linear_traversal round_result

let round_followed_by_linear_traversal (xs : int list) = 
  Raml.stat (round_followed_by_linear_traversal2 xs)

let rec map list f = match list with [] -> [] | x :: xs -> f x :: map xs f

;;

let input_dataset = [[7; 5; 3; 7; 2; 3; 7; 2];
[3; 1; 5; 6; 3; 6; 4; 8];
[1; 7; 6; 4; 3; 2; 6; 2];
[8; 4; 7; 3; 8; 7; 4; 5];
[8; 8; 7; 1; 2; 7; 2; 4];
[8; 12; 8; 4; 4; 1; 8; 9; 9; 12; 11; 12];
[7; 1; 9; 11; 3; 12; 10; 7; 2; 1; 11; 1];
[2; 2; 1; 10; 10; 6; 3; 10; 9; 12; 7; 2];
[5; 11; 12; 12; 7; 8; 2; 2; 3; 4; 6; 8];
[5; 10; 4; 11; 11; 11; 1; 7; 3; 7; 8; 8];
[10; 5; 9; 6; 2; 6; 8; 1; 5; 10; 15; 3; 15; 15; 9; 12; 5; 17];
[5; 1; 3; 3; 4; 7; 6; 11; 12; 7; 13; 15; 4; 11; 13; 12; 3; 12];
[4; 1; 13; 16; 18; 2; 11; 18; 13; 13; 17; 18; 4; 9; 15; 8; 6; 6];
[10; 10; 7; 18; 10; 8; 2; 2; 11; 17; 9; 15; 8; 16; 3; 4; 15; 6];
[16; 17; 9; 8; 7; 18; 12; 4; 18; 16; 1; 4; 9; 12; 2; 15; 13; 9];
[4; 24; 4; 7; 20; 20; 27; 8; 12; 4; 7; 5; 17; 21; 13; 25; 4; 9; 16; 13; 26; 20; 22; 8; 9; 6; 8];
[4; 15; 22; 27; 25; 3; 11; 8; 13; 26; 21; 3; 6; 9; 15; 2; 22; 20; 3; 22; 16; 6; 8; 13; 1; 21; 7];
[8; 15; 7; 5; 21; 27; 19; 23; 18; 2; 22; 3; 1; 27; 25; 25; 18; 11; 12; 21; 18; 1; 1; 16; 13; 14; 9];
[15; 23; 9; 4; 6; 12; 4; 15; 24; 7; 13; 4; 19; 9; 14; 1; 22; 17; 20; 9; 17; 11; 3; 24; 5; 24; 20];
[13; 20; 12; 2; 27; 10; 2; 6; 22; 15; 22; 7; 11; 4; 3; 18; 13; 22; 26; 9; 27; 21; 9; 11; 8; 10; 1];
[8; 8; 16; 6; 11; 30; 8; 22; 23; 6; 22; 15; 16; 28; 3; 38; 21; 26; 20; 17; 14; 8; 19; 16; 5; 12; 35; 38; 17; 4; 31; 23; 11; 1; 21; 32; 13; 27; 11; 29];
[33; 7; 4; 10; 23; 13; 1; 25; 11; 39; 32; 24; 37; 13; 29; 4; 3; 38; 23; 15; 18; 17; 29; 5; 30; 23; 19; 10; 9; 4; 35; 14; 25; 4; 8; 40; 14; 16; 4; 32];
[24; 19; 17; 2; 6; 34; 39; 21; 21; 18; 3; 6; 39; 22; 4; 23; 38; 27; 8; 14; 29; 27; 30; 7; 18; 18; 31; 31; 29; 37; 7; 8; 5; 12; 20; 29; 36; 6; 10; 17];
[33; 37; 13; 12; 33; 2; 2; 6; 35; 37; 22; 36; 40; 37; 13; 23; 14; 3; 23; 4; 1; 23; 24; 18; 5; 2; 14; 28; 20; 11; 32; 29; 23; 1; 22; 7; 9; 16; 35; 18];
[40; 26; 21; 21; 5; 14; 24; 27; 37; 3; 16; 34; 30; 5; 19; 39; 4; 5; 3; 24; 30; 18; 13; 38; 33; 2; 12; 21; 2; 5; 31; 28; 37; 26; 38; 29; 40; 27; 18; 36];
[44; 12; 22; 47; 20; 36; 19; 42; 52; 57; 54; 43; 36; 2; 18; 27; 20; 21; 44; 29; 21; 48; 28; 28; 33; 41; 3; 13; 60; 60; 58; 58; 16; 12; 3; 17; 19; 11; 51; 50; 32; 32; 44; 44; 2; 7; 14; 20; 13; 25; 6; 56; 59; 21; 15; 31; 21; 18; 54; 15];
[34; 49; 34; 31; 53; 12; 25; 4; 43; 39; 7; 53; 46; 8; 40; 19; 36; 34; 38; 5; 47; 28; 7; 54; 35; 24; 47; 15; 19; 30; 32; 3; 18; 46; 53; 6; 34; 17; 15; 12; 10; 55; 4; 54; 25; 47; 41; 17; 15; 13; 57; 6; 1; 30; 4; 19; 11; 19; 35; 14];
[11; 59; 37; 9; 56; 21; 48; 3; 45; 8; 49; 44; 28; 54; 7; 3; 21; 57; 11; 27; 60; 22; 22; 36; 29; 41; 46; 21; 48; 11; 47; 49; 31; 20; 32; 23; 5; 55; 59; 21; 43; 19; 16; 26; 2; 48; 2; 33; 17; 42; 6; 26; 16; 55; 55; 18; 32; 45; 24; 18];
[39; 20; 60; 42; 2; 15; 47; 1; 54; 48; 9; 47; 16; 5; 12; 20; 15; 49; 32; 51; 17; 26; 8; 29; 44; 4; 52; 22; 26; 35; 43; 54; 39; 25; 12; 39; 14; 28; 3; 47; 18; 53; 24; 30; 21; 54; 50; 49; 10; 57; 56; 57; 17; 16; 41; 8; 16; 56; 8; 25];
[52; 30; 53; 27; 50; 14; 39; 48; 54; 7; 5; 56; 60; 28; 10; 18; 25; 11; 56; 44; 1; 11; 28; 21; 20; 42; 40; 59; 35; 32; 49; 32; 60; 46; 52; 29; 42; 55; 41; 26; 48; 19; 4; 40; 14; 1; 32; 6; 44; 15; 46; 60; 49; 15; 41; 60; 1; 2; 47; 15];
[83; 76; 73; 67; 46; 78; 47; 81; 67; 63; 67; 30; 87; 65; 40; 78; 31; 60; 82; 63; 25; 50; 55; 86; 9; 71; 45; 28; 5; 40; 85; 41; 53; 70; 50; 41; 68; 17; 9; 17; 41; 21; 7; 16; 54; 50; 29; 3; 86; 83; 34; 57; 82; 55; 20; 67; 62; 21; 44; 33; 51; 66; 73; 89; 2; 17; 40; 29; 43; 23; 42; 60; 80; 7; 65; 3; 47; 81; 13; 64; 62; 56; 8; 52; 68; 19; 41; 1; 3; 83];
[29; 80; 56; 65; 67; 89; 70; 38; 26; 72; 37; 66; 33; 37; 68; 35; 48; 58; 81; 56; 90; 34; 70; 41; 55; 57; 41; 64; 45; 21; 33; 55; 55; 41; 62; 47; 14; 50; 20; 80; 24; 85; 28; 82; 45; 11; 75; 70; 47; 40; 36; 37; 57; 64; 24; 50; 20; 20; 23; 60; 3; 21; 39; 1; 60; 12; 87; 32; 32; 2; 16; 45; 15; 20; 69; 88; 32; 57; 87; 13; 19; 75; 56; 28; 36; 68; 48; 83; 44; 39];
[15; 50; 29; 68; 14; 62; 88; 31; 43; 62; 55; 52; 30; 34; 83; 8; 20; 68; 71; 44; 87; 72; 44; 26; 80; 3; 71; 20; 44; 37; 8; 71; 23; 50; 44; 63; 62; 57; 3; 4; 31; 19; 21; 67; 22; 39; 16; 22; 79; 53; 36; 86; 10; 69; 14; 78; 58; 62; 71; 90; 61; 40; 54; 90; 51; 23; 34; 2; 72; 79; 5; 12; 74; 18; 50; 77; 9; 20; 2; 63; 62; 82; 70; 40; 70; 2; 81; 89; 8; 43];
[65; 35; 84; 34; 15; 54; 54; 48; 30; 43; 68; 43; 32; 52; 19; 73; 90; 14; 44; 67; 2; 49; 72; 47; 45; 27; 28; 37; 9; 64; 39; 27; 3; 47; 63; 8; 69; 87; 89; 19; 3; 27; 39; 76; 56; 71; 4; 83; 34; 24; 89; 74; 46; 33; 5; 26; 28; 41; 41; 64; 33; 16; 75; 44; 14; 25; 26; 16; 75; 16; 18; 87; 85; 44; 54; 60; 39; 67; 36; 73; 74; 35; 69; 40; 38; 65; 23; 7; 53; 7];
[31; 45; 27; 4; 47; 34; 26; 35; 10; 61; 41; 6; 52; 46; 33; 5; 26; 47; 28; 1; 40; 21; 44; 42; 8; 28; 44; 90; 61; 28; 1; 76; 40; 44; 9; 14; 75; 21; 67; 14; 44; 19; 21; 9; 66; 53; 70; 12; 83; 51; 57; 67; 33; 54; 39; 49; 31; 11; 83; 62; 10; 33; 12; 33; 63; 69; 56; 69; 16; 49; 54; 36; 75; 1; 26; 66; 55; 57; 73; 38; 46; 19; 10; 84; 24; 3; 31; 73; 22; 65];
[89; 38; 122; 63; 57; 100; 49; 135; 36; 27; 101; 6; 103; 28; 25; 51; 69; 3; 72; 10; 109; 60; 63; 106; 101; 72; 15; 77; 129; 3; 92; 109; 5; 92; 70; 57; 107; 13; 128; 52; 20; 56; 12; 46; 130; 80; 22; 113; 97; 46; 67; 99; 89; 122; 86; 135; 86; 66; 16; 105; 103; 90; 52; 23; 98; 35; 115; 106; 38; 2; 33; 67; 96; 114; 32; 121; 14; 121; 78; 125; 85; 132; 125; 43; 127; 80; 27; 104; 10; 4; 47; 61; 21; 83; 26; 66; 30; 52; 42; 16; 122; 125; 13; 119; 10; 102; 76; 99; 78; 17; 20; 46; 55; 78; 53; 61; 112; 48; 10; 103; 6; 131; 114; 87; 94; 23; 75; 3; 12; 74; 37; 135; 57; 113; 124];
[110; 50; 10; 56; 95; 60; 101; 89; 1; 63; 16; 120; 111; 53; 131; 1; 133; 95; 56; 119; 90; 42; 87; 117; 119; 2; 94; 2; 117; 113; 130; 95; 34; 59; 77; 105; 64; 117; 100; 50; 89; 61; 67; 47; 88; 73; 132; 70; 54; 44; 21; 33; 100; 12; 86; 66; 90; 21; 127; 58; 99; 5; 61; 82; 130; 84; 86; 101; 106; 71; 125; 96; 24; 36; 90; 130; 121; 134; 19; 21; 56; 105; 23; 28; 114; 46; 116; 120; 75; 129; 135; 125; 77; 128; 52; 56; 81; 61; 51; 55; 96; 108; 133; 70; 22; 98; 129; 110; 28; 41; 6; 29; 127; 48; 83; 96; 49; 72; 97; 86; 32; 62; 106; 32; 91; 135; 90; 91; 100; 14; 102; 125; 99; 92; 92];
[16; 48; 66; 88; 105; 5; 52; 71; 56; 22; 112; 92; 17; 101; 65; 91; 88; 25; 74; 89; 67; 115; 44; 131; 58; 63; 32; 20; 103; 62; 82; 74; 48; 120; 110; 117; 22; 1; 42; 44; 125; 3; 90; 21; 67; 98; 12; 22; 75; 93; 32; 50; 131; 88; 85; 74; 64; 134; 98; 22; 39; 128; 106; 42; 44; 119; 79; 133; 46; 97; 73; 109; 129; 59; 20; 33; 4; 34; 47; 8; 61; 115; 89; 130; 122; 134; 19; 58; 100; 116; 119; 112; 66; 71; 79; 81; 110; 26; 6; 99; 45; 126; 82; 29; 100; 95; 46; 77; 33; 115; 85; 42; 106; 103; 114; 75; 100; 106; 97; 87; 93; 126; 28; 54; 86; 98; 98; 133; 82; 15; 50; 41; 26; 98; 127];
[7; 109; 19; 50; 59; 19; 126; 129; 45; 102; 54; 2; 51; 79; 94; 124; 86; 116; 59; 14; 46; 118; 11; 124; 64; 32; 110; 10; 23; 14; 40; 113; 18; 34; 19; 13; 107; 36; 8; 19; 5; 5; 72; 16; 29; 22; 9; 29; 104; 68; 112; 46; 126; 12; 6; 50; 65; 47; 120; 103; 130; 76; 80; 74; 69; 5; 126; 82; 101; 60; 105; 126; 115; 81; 14; 114; 52; 68; 13; 122; 25; 88; 3; 17; 10; 1; 59; 5; 43; 73; 19; 27; 134; 58; 70; 43; 16; 4; 86; 29; 4; 99; 118; 132; 126; 18; 19; 15; 119; 23; 32; 133; 118; 33; 95; 37; 16; 40; 27; 104; 65; 101; 33; 86; 101; 67; 32; 45; 63; 1; 76; 134; 126; 2; 17];
[106; 58; 67; 3; 97; 101; 118; 30; 44; 115; 14; 34; 79; 59; 116; 99; 87; 96; 67; 5; 13; 124; 2; 120; 99; 120; 117; 78; 12; 124; 85; 120; 55; 76; 87; 52; 98; 89; 101; 5; 25; 100; 70; 47; 115; 51; 65; 118; 52; 4; 34; 19; 128; 43; 29; 119; 90; 104; 57; 132; 41; 66; 25; 70; 112; 8; 101; 42; 129; 125; 18; 83; 134; 30; 21; 67; 69; 118; 23; 3; 107; 39; 9; 85; 83; 132; 112; 114; 31; 72; 8; 122; 129; 86; 82; 121; 82; 52; 127; 13; 27; 38; 128; 50; 77; 12; 2; 89; 93; 53; 44; 103; 41; 61; 55; 1; 101; 8; 53; 101; 13; 126; 4; 53; 59; 15; 94; 7; 50; 106; 80; 71; 7; 57; 47]]
in map input_dataset round_followed_by_linear_traversal
